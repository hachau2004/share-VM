Æ°á»›c 1. Cáº­p nháº­t Ubuntu

Má»Ÿ terminal vÃ  cháº¡y:

sudo apt update


Má»¥c Ä‘Ã­ch: lÃ m má»›i danh sÃ¡ch gÃ³i pháº§n má»m trong kho Ubuntu.

ğŸ”¹ BÆ°á»›c 2. CÃ i cÃ´ng cá»¥ cÆ¡ báº£n
sudo apt install -y curl git docker.io


DÃ¹ng Ä‘á»ƒ táº£i file (curl), clone repo (git), vÃ  cháº¡y container (docker).

Kiá»ƒm tra:

curl --version
git --version
docker --version
XÃ³a báº£n cÅ© (x86_64) vá»«a táº£i
sudo rm /usr/local/lib/docker/cli-plugins/docker-compose

ğŸ”¹ 2ï¸âƒ£ Táº£i Ä‘Ãºng báº£n dÃ nh cho ARM64
sudo curl -fSL "https://github.com/docker/compose/releases/latest/download/docker-compose-linux-aarch64" \
  -o /usr/local/lib/docker/cli-plugins/docker-compose

ğŸ”¹ 3ï¸âƒ£ Cáº¥p quyá»n thá»±c thi
sudo chmod +x /usr/local/lib/docker/cli-plugins/docker-compose

ğŸ”¹ 4ï¸âƒ£ Kiá»ƒm tra láº¡i
docker compose version


âœ… Náº¿u thÃ nh cÃ´ng, báº¡n sáº½ tháº¥y káº¿t quáº£ kiá»ƒu:

Docker Compose version v2.xx.x

âš ï¸ Náº¿u váº«n bÃ¡o lá»—i â€œunknown commandâ€

Cháº¡y thá»­:

docker --help | grep compose


Náº¿u khÃ´ng tháº¥y gÃ¬, khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥ Docker:

sudo systemctl restart docker


Rá»“i kiá»ƒm tra láº¡i lá»‡nh:

docker compose version


ğŸ”¹ BÆ°á»›c 3. CÃ i Docker Compose (v2)
sudo mkdir -p /usr/local/lib/docker/cli-plugins
sudo curl -fSL "https://github.com/docker/compose/releases/latest/download/docker-compose-linux-x86_64" \
  -o /usr/local/lib/docker/cli-plugins/docker-compose
sudo chmod +x /usr/local/lib/docker/cli-plugins/docker-compose
docker compose version

ğŸ”¹ BÆ°á»›c 4. Cho phÃ©p cháº¡y Docker khÃ´ng cáº§n sudo
sudo usermod -aG docker $USER
newgrp docker

ğŸ”¹ BÆ°á»›c 5. CÃ i Node.js 22.x
curl -fsSL https://deb.nodesource.com/setup_22.x | sudo -E bash -
sudo apt-get install -y nodejs
nodejs -v
npm -v

ğŸ”¹ BÆ°á»›c 6. CÃ i Go 1.24.0
wget https://go.dev/dl/go1.24.0.linux-amd64.tar.gz
sudo tar -C /usr/local -xzf go1.24.0.linux-amd64.tar.gz
echo 'export GOROOT=/usr/local/go' >> ~/.bashrc
echo 'export GOPATH=$HOME/go' >> ~/.bashrc
echo 'export PATH=$PATH:$GOROOT/bin:$GOPATH/bin' >> ~/.bashrc
source ~/.bashrc
go version

FIX GO:
XÃ³a báº£n Go cÅ© bá»‹ sai kiáº¿n trÃºc:

sudo rm -rf /usr/local/go


2ï¸âƒ£ Táº£i Ä‘Ãºng báº£n Go 1.24.0 ARM64:

wget https://go.dev/dl/go1.24.0.linux-arm64.tar.gz


3ï¸âƒ£ Giáº£i nÃ©n vÃ  cáº¥u hÃ¬nh láº¡i:

sudo tar -C /usr/local -xzf go1.24.0.linux-arm64.tar.gz
echo 'export GOROOT=/usr/local/go' >> ~/.bashrc
echo 'export GOPATH=$HOME/go' >> ~/.bashrc
echo 'export PATH=$PATH:$GOROOT/bin:$GOPATH/bin' >> ~/.bashrc
source ~/.bashrc


4ï¸âƒ£ Kiá»ƒm tra láº¡i:

go version


âœ… Káº¿t quáº£ mong Ä‘á»£i:

go version go1.24.0 linux/arm64


ğŸ”¹ BÆ°á»›c 7. CÃ i Hyperledger Fabric 3.1.0 vÃ  CA 1.5.10
git clone https://github.com/hyperledger/fabric-samples.git
cd fabric-samples
curl -LO https://github.com/hyperledger/fabric/releases/download/v3.1.0/hyperledger-fabric-linux-amd64-3.1.0.tar.gz
tar -xzf hyperledger-fabric-linux-amd64-3.1.0.tar.gz -C .

curl -LO https://github.com/hyperledger/fabric-ca/releases/download/v1.5.10/hyperledger-fabric-ca-linux-amd64-1.5.10.tar.gz
tar -xzf hyperledger-fabric-ca-linux-amd64-1.5.10.tar.gz -C .

echo 'export PATH=$HOME/fabric-samples/bin:$PATH' >> ~/.bashrc
echo 'export FABRIC_CFG_PATH=$HOME/fabric-samples/config' >> ~/.bashrc
source ~/.bashrc

peer version
fabric-ca-client version

FIX PEER VERSION:
ğŸ”¹ 1ï¸âƒ£ XÃ³a báº£n cÅ© bá»‹ sai kiáº¿n trÃºc
rm -rf ~/fabric-samples/bin

ğŸ”¹ 2ï¸âƒ£ Táº£i Ä‘Ãºng báº£n cho ARM64

Hiá»‡n Hyperledger chÆ°a phÃ¡t hÃ nh binary chÃ­nh thá»©c cho ARM,
nhÆ°ng cÃ³ thá»ƒ cháº¡y báº±ng Docker ARM64 images, tá»©c lÃ  bá» qua pháº§n binary,
vÃ¬ cÃ¡c container (orderer, peer, CAâ€¦) Ä‘á»u cÃ³ image ARM64 sáºµn.

ğŸ‘‰ Táº£i bá»™ fabric-samples Ä‘Ãºng cÃ¡ch:

cd ~
rm -rf fabric-samples
git clone https://github.com/hyperledger/fabric-samples.git
cd fabric-samples

ğŸ”¹ 3ï¸âƒ£ KÃ©o vá» Docker image ARM64

Cháº¡y lá»‡nh nÃ y (thay cho viá»‡c cháº¡y peer trá»±c tiáº¿p):

docker pull hyperledger/fabric-peer:3.1
docker pull hyperledger/fabric-orderer:3.1
docker pull hyperledger/fabric-ca:1.5.10
docker pull hyperledger/fabric-tools:3.1

FIX DOCKER:
docker pull hyperledger/fabric-tools:2.5
ğŸ’¡ Sau khi táº£i xong, kiá»ƒm tra toÃ n bá»™ image:
bash
Sao chÃ©p mÃ£
docker images | grep hyperledger



CÃ¡c image nÃ y Ä‘á»u cÃ³ báº£n linux/arm64 â€” VirtualBox ARM sáº½ cháº¡y Ä‘Æ°á»£c.

ğŸ”¹ 4ï¸âƒ£ Sá»­a láº¡i biáº¿n mÃ´i trÆ°á»ng (chá»‰ giá»¯ pháº§n config)

KhÃ´ng cáº§n PATH trá» tá»›i bin/ ná»¯a:

echo 'export FABRIC_CFG_PATH=$HOME/fabric-samples/config' >> ~/.bashrc
source ~/.bashrc

ğŸ”¹ 5ï¸âƒ£ Kiá»ƒm tra Docker image
docker images | grep hyperledger


â†’ Náº¿u tháº¥y cÃ¡c dÃ²ng fabric-peer, fabric-orderer, fabric-ca lÃ  OK âœ…



âš™ï¸ PHáº¦N 2 â€“ LAB 4.1: Dá»±ng máº¡ng Bankchain
ğŸ”¹ BÆ°á»›c 1. Clone project Bankchain
cd ~/fabric-samples
git clone https://github.com/PacktPublishing/Blockchain-Development-for-Finance-Projects.git
cd Blockchain-Development-for-Finance-Projects/Chapter4/bankchain

FIX:
cd ~/fabric-samples/Blockchain-Development-for-Finance-Projects
ls

ğŸ”¹ BÆ°á»›c 2. Sinh chá»©ng chá»‰ sá»‘
cryptogen generate --config=./crypto-config.yaml --output=./crypto-config

FIXX:
CÃ¡ch kháº¯c phá»¥c lá»—i cryptogen: command not found
ğŸ§© BÆ°á»›c 1. Táº£i cÃ¡c binary cá»§a Hyperledger Fabric

Cháº¡y cÃ¡c lá»‡nh sau:

cd ~
curl -sSL https://bit.ly/2ysbOFE | bash -s


ğŸ”¹ Lá»‡nh nÃ y sáº½ táº£i vá» cÃ¡c cÃ´ng cá»¥ (tool binaries) cá»§a Fabric gá»“m:
cryptogen, configtxgen, peer, orderer, v.v.
VÃ  tá»± Ä‘á»™ng Ä‘áº·t chÃºng trong thÆ° má»¥c ~/fabric-samples/bin.

ğŸ§© BÆ°á»›c 2. ThÃªm vÃ o PATH

Sau khi táº£i xong, thÃªm dÃ²ng sau vÃ o file ~/.bashrc:

export PATH=$PATH:$HOME/fabric-samples/bin


Rá»“i cháº¡y láº¡i:

source ~/.bashrc

ğŸ§© BÆ°á»›c 3. Kiá»ƒm tra láº¡i

Cháº¡y:

cryptogen version


âœ… Náº¿u hiá»‡n ra thÃ´ng tin nhÆ°:

cryptogen:
 Version: 2.5.0
...


lÃ  Ä‘Ã£ OK.

Sau Ä‘Ã³, quay láº¡i thÆ° má»¥c bankchain vÃ  cháº¡y láº¡i lá»‡nh:

cd ~/fabric-samples/Blockchain-Development-for-Finance-Projects/Chapter\ 4/bankchain
cryptogen generate --config=./crypto-config.yaml --output=./crypto-config

ğŸ”¹ BÆ°á»›c 3. Sinh channel block
export FABRIC_CFG_PATH=$PWD
mkdir -p channel-artifacts
configtxgen -profile BankChannel -channelID bankchannel -outputBlock ./channel-artifacts/bankchannel.block

FIXXXX:
BÆ°á»›c 1 â€“ Kiá»ƒm tra láº¡i file configtx.yaml

Cháº¡y lá»‡nh sau trong thÆ° má»¥c bankchain:

cat configtx.yaml | grep Profile -A 5


Náº¿u khÃ´ng tháº¥y dÃ²ng:

Profiles:
    BankChannel:


â†’ thÃ¬ báº¡n Ä‘ang thiáº¿u Ä‘á»‹nh nghÄ©a profile BankChannel.

BÆ°á»›c 2 â€“ Má»Ÿ file configtx.yaml vÃ  thÃªm Ä‘oáº¡n sau á»Ÿ cuá»‘i (náº¿u chÆ°a cÃ³)

Má»Ÿ file:

nano configtx.yaml


Profiles:

    TwoOrgsOrdererGenesis:
        <<: *ChannelDefaults
        Orderer:
            <<: *OrdererDefaults
            Organizations:
                - *OrdererOrg
            Capabilities:
                <<: *OrdererCapabilities
        Consortiums:
            SampleConsortium:
                Organizations:
                    - *Org1
                    - *Org2

    TwoOrgsChannel:
        Consortium: SampleConsortium
        <<: *ChannelDefaults
        Application:
            <<: *ApplicationDefaults
            Organizations:
                - *Org1
                - *Org2
            Capabilities:
                <<: *ApplicationCapabilities

    BankChannel:
        Consortium: SampleConsortium
        <<: *ChannelDefaults
        Application:
            <<: *ApplicationDefaults
            Organizations:
                - *Org1
                - *Org2
            Capabilities:
                <<: *ApplicationCapabilities



(LÆ°u Ã½: â€œBankAâ€ vÃ  â€œBankBâ€ pháº£i trÃ¹ng vá»›i tÃªn Org trong pháº§n Organizations: á»Ÿ Ä‘áº§u file configtx.yaml.)

BÆ°á»›c 3 â€“ Cháº¡y láº¡i lá»‡nh

Sau khi lÆ°u file (Ctrl + O, Enter, Ctrl + X):

configtxgen -profile BankChannel -channelID bankchannel -outputBlock ./channel-artifacts/bankchannel.block


Náº¿u tháº¥y:

INFO Generated new channel genesis block

ğŸ”¹ BÆ°á»›c 4. Cháº¡y Orderer vÃ  Peers
docker compose -f docker-compose-bankchain.yaml up -d


Náº¿u lá»—i /etc/hyperledger/fabric, hÃ£y:

touch dummy_fabric
mkdir -p orderer-config


Sau Ä‘Ã³ sá»­a file docker-compose-bankchain.yaml thÃªm 2 dÃ²ng mount:

      - ./dummy_fabric:/etc/hyperledger/fabric
      - ./orderer-config:/etc/hyperledger/orderer-cfg

ğŸ”¹ BÆ°á»›c 5. Kiá»ƒm tra máº¡ng
docker ps


Pháº£i tháº¥y cÃ¡c container orderer, peer0.banka, peer0.bankb, cli Ä‘ang â€œUpâ€.

ğŸªª PHáº¦N 3 â€“ LAB 4.2: Táº¡o danh tÃ­nh cho cÃ¡c ngÃ¢n hÃ ng
npm i fabric-ca-client fabric-network
node enrollAdmin-BankA.js
node registerUser-BankA.js
node enrollAdmin-BankB.js
node registerUser-BankB.js
ls wallet-BankA/
ls wallet-BankB/


Káº¿t quáº£: 2 thÆ° má»¥c wallet chá»©a danh tÃ­nh admin vÃ  user cho 2 ngÃ¢n hÃ ng.
