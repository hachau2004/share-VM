BƯỚC 1 — Vào trong container CLI

Chạy:

docker exec -it cli bash


Nếu vào được sẽ thấy dòng kiểu như:

root@cli:/opt/gopath/src/github.com/hyperledger/fabric/peer#

✅ BƯỚC 2 — Xuất tên channel

Trong CLI:

export CHANNEL_NAME=bankchannel

✅ BƯỚC 3 — Tạo channel block

Trong CLI chạy:

peer channel create \
  -o orderer.example.com:7050 \
  -c $CHANNEL_NAME \
  -f ./channel-artifacts/channel.tx \
  --outputBlock ./channel-artifacts/bankchannel.block \
  --tls \
  --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/tls/ca.crt


hachau@hachau:~/fabric-samples/bankchain$ docker exec -it cli bash
root@ca7633c40326:/opt/gopath/src/github.com/hyperledger/fabric/peer# export CHANNEL_NAME=bankchannel
root@ca7633c40326:/opt/gopath/src/github.com/hyperledger/fabric/peer# peer channel create \
  -o orderer.example.com:7050 \
  -c $CHANNEL_NAME \
  -f ./channel-artifacts/channel.tx \
  --outputBlock ./channel-artifacts/bankchannel.block \
  --tls \
  --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/tls/ca.crt
2025-11-09 08:33:37.619 UTC 0001 INFO [channelCmd] InitCmdFactory -> Endorser and orderer connections initialized
2025-11-09 08:33:37.637 UTC 0002 INFO [cli.common] readBlock -> Expect block, but got status: &{NOT_FOUND}
2025-11-09 08:33:37.641 UTC 0003 INFO [channelCmd] InitCmdFactory -> Endorser and orderer connections initialized
2025-11-09 08:33:37.843 UTC 0004 INFO [cli.common] readBlock -> Expect block, but got status: &{SERVICE_UNAVAILABLE}
2025-11-09 08:33:37.846 UTC 0005 INFO [channelCmd] InitCmdFactory -> Endorser and orderer connections initialized
2025-11-09 08:33:38.047 UTC 0006 INFO [cli.common] readBlock -> Expect block, but got status: &{SERVICE_UNAVAILABLE}
2025-11-09 08:33:38.052 UTC 0007 INFO [channelCmd] InitCmdFactory -> Endorser and orderer connections initialized
2025-11-09 08:33:38.253 UTC 0008 INFO [cli.common] readBlock -> Expect block, but got status: &{SERVICE_UNAVAILABLE}
2025-11-09 08:33:38.257 UTC 0009 INFO [channelCmd] InitCmdFactory -> Endorser and orderer connections initialized
2025-11-09 08:33:38.459 UTC 000a INFO [cli.common] readBlock -> Expect block, but got status: &{SERVICE_UNAVAILABLE}
2025-11-09 08:33:38.465 UTC 000b INFO [channelCmd] InitCmdFactory -> Endorser and orderer connections initialized
2025-11-09 08:33:38.667 UTC 000c INFO [cli.common] readBlock -> Received block: 0
root@ca7633c40326:/opt/gopath/src/github.com/hyperledger/fabric/peer# peer channel join -b ./channel-artifacts/bankchannel.block
Error: error getting endorser client for channel: endorser client failed to connect to peer0.banka.example.com:7051: failed to create new connection: connection error: desc = "transport: error while dialing: dial tcp: lookup peer0.banka.example.com on 127.0.0.11:53: no such host"
root@ca7633c40326:/opt/gopath/src/github.com/hyperledger/fabric/peer# 
✅ Kết quả đúng sẽ có dòng:

Channel creation successful

✅ BƯỚC 4 — Peer0 BankA JOIN CHANNEL

Trong CLI:

peer channel join -b ./channel-artifacts/bankchannel.block


✅ Nếu đúng sẽ thấy:

Successfully submitted proposal to join channel

✅ BƯỚC 5 — CHO PEER1 BANK A JOIN CHANNEL

Vẫn trong CLI, nhưng đổi ENV sang peer1:

export CORE_PEER_ADDRESS=peer1.banka.example.com:8051
export CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/banka.example.com/peers/peer1.banka.example.com/tls/server.crt
export CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/banka.example.com/peers/peer1.banka.example.com/tls/server.key
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/banka.example.com/peers/peer1.banka.example.com/tls/ca.crt
export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/banka.example.com/users/Admin@banka.example.com/msp


Join:

peer channel join -b ./channel-artifacts/bankchannel.block

✅ BƯỚC 6 — CHO PEER0 BANK B JOIN CHANNEL

Vẫn trong CLI nhưng chuyển ENV sang org B:

export CORE_PEER_LOCALMSPID=bankbMSP
export CORE_PEER_ADDRESS=peer0.bankb.example.com:9051
export CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/bankb.example.com/peers/peer0.bankb.example.com/tls/server.crt
export CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/bankb.example.com/peers/peer0.bankb.example.com/tls/server.key
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/bankb.example.com/peers/peer0.bankb.example.com/tls/ca.crt
export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/bankb.example.com/users/Admin@bankb.example.com/msp


Join:

peer channel join -b ./channel-artifacts/bankchannel.block

✅ BƯỚC 7 — PEER1 BANK B JOIN
export CORE_PEER_ADDRESS=peer1.bankb.example.com:10051
export CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/bankb.example.com/peers/peer1.bankb.example.com/tls/server.crt
export CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/bankb.example.com/peers/peer1.bankb.example.com/tls/server.key
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/bankb.example.com/peers/peer1.bankb.example.com/tls/ca.crt
export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/bankb.example.com/users/Admin@bankb.example.com/msp


Join:

peer channel join -b ./channel-artifacts/bankchannel.block

✅ BƯỚC 8 — Kiểm tra tất cả peer đã join
peer channel list


Ở mỗi peer phải thấy:

bankchannel
