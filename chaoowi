‚úÖ GI·∫¢I PH√ÅP D·ª®T ƒêI·ªÇM ‚Äî KH·ªûI T·∫†O L·∫†I CLI ƒê√öNG C√ÅCH
‚úÖ B∆∞·ªõc 1: T·∫Øt to√†n b·ªô container
docker compose -f docker-compose-bankchain.yaml down

‚úÖ B∆∞·ªõc 2: X√≥a CLI container ho√†n to√†n
docker rm -f cli

‚úÖ B∆∞·ªõc 3: B·∫≠t l·∫°i to√†n b·ªô h·ªá th·ªëng
docker compose -f docker-compose-bankchain.yaml up -d


üìå L√∫c n√†y CLI s·∫Ω ƒë∆∞·ª£c g·∫Øn ƒë√∫ng v√†o network bankchain_bankchain v√† DNS s·∫Ω ho·∫°t ƒë·ªông.

‚úÖ B∆∞·ªõc 4: Ki·ªÉm tra CLI ƒë√£ th·∫•y peer ch∆∞a
docker exec -it cli bash
getent hosts peer0.banka.example.com


‚úÖ N·∫øu th·∫•y d·∫°ng:
hachau@hachau:~/fabric-samples/bankchain$ docker exec -it cli bash
root@78db66c70e8b:/opt/gopath/src/github.com/hyperledger/fabric/peer# getent hosts peer0.banka.example.com
root@78db66c70e8b:/opt/gopath/src/github.com/hyperledger/fabric/peer# 
172.22.0.5   peer0.banka.example.com


‚Üí OK ‚Äî CLI ƒë√£ nh√¨n th·∫•y peer.

‚ùå N·∫øu v·∫´n kh√¥ng th·∫•y ‚Üí m√¨nh xem l·∫°i docker-compose cho b·∫°n.

‚úÖ B∆∞·ªõc 5: Export l·∫°i bi·∫øn m√¥i tr∆∞·ªùng v√† join peer

Trong CLI:

export CORE_PEER_LOCALMSPID="bankaMSP"
export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/banka.example.com/users/Admin@banka.example.com/msp
export CORE_PEER_ADDRESS=peer0.banka.example.com:7051
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/banka.example.com/peers/peer0.banka.example.com/tls/ca.crt

export CHANNEL_NAME=bankchannel


R·ªìi:

peer channel join -b ./channel-artifacts/bankchannel.block

‚úÖ T√ìM L·∫†I L·ªñI

CLI KH√îNG PH·∫¢I ·ªû ƒê√öNG NETWORK ‚Üí KH√îNG RESOLVE DNS ‚Üí KH√îNG T√åM TH·∫§Y peer0.banka.example.com ‚Üí join channel th·∫•t b·∫°i.

‚ö° B·∫°n h√£y ch·∫°y 3 l·ªánh n√†y r·ªìi g·ª≠i m√¨nh k·∫øt qu·∫£ c·ªßa getent hosts.peer0.banka.example.com:

docker compose -f docker-compose-bankchain.yaml down
docker rm -f cli
docker compose -f docker-compose-bankchain.yaml up -d


r·ªìi:

docker exec -it cli bash
getent hosts peer0.banka.example.com 



‚úÖ B∆∞·ªõc 1 ‚Äî Export l·∫°i bi·∫øn m√¥i tr∆∞·ªùng ƒë√∫ng

üîµ V√ÄO TRONG CLI:

docker exec -it cli bash


R·ªìi ch·∫°y:

export CORE_PEER_LOCALMSPID="bankaMSP"
export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/banka.example.com/users/Admin@banka.example.com/msp
export CORE_PEER_ADDRESS=peer0.banka.example.com:7051
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/banka.example.com/peers/peer0.banka.example.com/tls/ca.crt

export CHANNEL_NAME=bankchannel
hachau@hachau:~/fabric-samples/bankchain$ docker compose -f docker-compose-bankchain.yaml down
WARN[0000] The "SYS_CHANNEL" variable is not set. Defaulting to a blank string. 
WARN[0000] /home/hachau/fabric-samples/bankchain/docker-compose-bankchain.yaml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion 
[+] Running 11/11
 ‚úî Container peer1.bankb.example.com  Removed                              0.0s 
 ‚úî Container cli                      Removed                             10.2s 
 ‚úî Container peer0.bankb.example.com  Removed                              0.0s 
 ‚úî Container peer1.banka.example.com  Removed                              0.0s 
 ‚úî Container couchdb3                 Removed                              0.0s 
 ‚úî Container couchdb1                 Removed                              0.0s 
 ‚úî Container couchdb2                 Removed                              0.0s 
 ‚úî Container orderer.example.com      R...                                 0.1s 
 ‚úî Container peer0.banka.example.com  Removed                              0.0s 
 ‚úî Container couchdb0                 Removed                              0.0s 
 ‚úî Network bankchain_bankchain        Rem...                               0.1s 
hachau@hachau:~/fabric-samples/bankchain$ docker rm -f cli
Error response from daemon: No such container: cli
hachau@hachau:~/fabric-samples/bankchain$ docker compose -f docker-compose-bankchain.yaml up -d
WARN[0000] The "SYS_CHANNEL" variable is not set. Defaulting to a blank string. 
WARN[0000] /home/hachau/fabric-samples/bankchain/docker-compose-bankchain.yaml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion 
[+] Running 11/11
 ‚úî Network bankchain_bankchain        Cre...                               0.0s 
 ‚úî Container couchdb3                 Started                              0.3s 
 ‚úî Container couchdb0                 Started                              0.4s 
 ‚úî Container couchdb1                 Started                              0.4s 
 ‚úî Container orderer.example.com      S...                                 0.3s 
 ‚úî Container couchdb2                 Started                              0.4s 
 ‚úî Container peer1.bankb.example.com  Started                              0.5s 
 ‚úî Container peer0.banka.example.com  Started                              0.6s 
 ‚úî Container peer0.bankb.example.com  Started                              0.7s 
 ‚úî Container peer1.banka.example.com  Started                              0.7s 
 ‚úî Container cli                      Started                              0.7s 
hachau@hachau:~/fabric-samples/bankchain$ 
