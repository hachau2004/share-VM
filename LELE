ğŸ”§ CÃ¡ch sá»­a lá»—i â€œdocker: unknown command: docker composeâ€
ğŸªœ BÆ°á»›c 1: Kiá»ƒm tra Docker Ä‘Ã£ nháº­n plugin chÆ°a

Cháº¡y lá»‡nh:

ls /usr/libexec/docker/cli-plugins/


Náº¿u báº¡n tháº¥y cÃ³ file tÃªn:

docker-compose


â†’ LÃ  plugin Ä‘Ã£ Ä‘Æ°á»£c cÃ i Ä‘Ãºng chá»—, nhÆ°ng Docker chÆ°a nháº­n ra.

ğŸªœ BÆ°á»›c 2: Kiá»ƒm tra Ä‘Æ°á»ng dáº«n CLI plugin

Cháº¡y lá»‡nh:

docker version


á» cuá»‘i sáº½ cÃ³ dÃ²ng â€œClient:â€ â†’ xem Docker Root Dir hoáº·c CLI Plugins Dir.
Náº¿u /usr/libexec/docker/cli-plugins khÃ´ng náº±m trong Ä‘Ã³, ta cáº§n táº¡o symlink.

ğŸªœ BÆ°á»›c 3: Táº¡o liÃªn káº¿t Ä‘á»ƒ Docker nháº­n Compose

Cháº¡y lá»‡nh sau:

sudo mkdir -p /usr/local/lib/docker/cli-plugins
sudo ln -s /usr/libexec/docker/cli-plugins/docker-compose /usr/local/lib/docker/cli-plugins/docker-compose

ğŸªœ BÆ°á»›c 4: Kiá»ƒm tra láº¡i

Giá» cháº¡y láº¡i lá»‡nh:

docker compose version


Náº¿u ra vÃ­ dá»¥ nhÆ°:

Docker Compose version v2.24.0


â†’ âœ… OK rá»“i!

ğŸªœ BÆ°á»›c 5: Cháº¡y láº¡i lá»‡nh khá»Ÿi Ä‘á»™ng máº¡ng Bankchain
docker compose \
  -f docker-compose-bankchain.yaml \
  -f docker-compose-ca.yaml \
  -f docker-compose-couch.yaml \
  up -d

â›“ BÆ°á»›c 4 â€” Táº¡o channel & test
(a) Copy genesis block vÃ o orderer
docker cp ./channel-artifacts/bkchannel.block orderer.bankchain.com:/var/hyperledger/orderer/bkchannel.block

(b) Orderer join channel
docker exec -it orderer.bankchain.com bash -lc \
'osnadmin channel join \
  --channelID bkchannel \
  --config-block /var/hyperledger/orderer/bkchannel.block \
  -o localhost:7053 \
  --ca-file /var/hyperledger/orderer/tls/ca.crt \
  --client-cert /var/hyperledger/orderer/tls/server.crt \
  --client-key /var/hyperledger/orderer/tls/server.key'


Kiá»ƒm tra:

docker exec orderer.bankchain.com osnadmin channel list -o localhost:7053 \
  --ca-file /var/hyperledger/orderer/tls/ca.crt \
  --client-cert /var/hyperledger/orderer/tls/server.crt \
  --client-key /var/hyperledger/orderer/tls/server.key

(c) Peer join channel (tá»« container CLI)
docker exec -it cli bash


â†’ Trong CLI container, cháº¡y láº§n lÆ°á»£t cÃ¡c lá»‡nh:

export CHANNEL_NAME=bkchannel
export ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/bankchain.com/orderers/orderer.bankchain.com/tls/ca.crt


Rá»“i cháº¡y tiáº¿p cÃ¡c lá»‡nh peer channel join cho tá»«ng peer (nhÆ° hÆ°á»›ng dáº«n cá»§a báº¡n gá»­i).

sudo curl -L "https://github.com/docker/compose/releases/download/v2.24.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose

docker-compose \
  -f docker-compose-bankchain.yaml \
  -f docker-compose-ca.yaml \
  -f docker-compose-couch.yaml \
  up -d

